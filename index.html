<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EsLink - –°–æ–∫—Ä–∞—â–∞—Ç–µ–ª—å —Å—Å—ã–ª–æ–∫</title>
    <style>
        :root {
            --primary: #8B5FBF;
            --secondary: #C74BD3;
            --accent: #E83D84;
            --dark-bg: #121212;
            --dark-card: #1E1E1E;
            --dark-text: #E0E0E0;
            --dark-border: #333333;
            --light: #f8f9fa;
            --success: #6AECB3;
            --warning: #FF6B9D;
            --border-radius: 12px;
            --shadow: 0 10px 20px rgba(0,0,0,0.3);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: var(--dark-text);
        }

        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--accent), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0.8;
            font-weight: 300;
        }

        .card {
            background: var(--dark-card);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 30px;
            transition: var(--transition);
            border: 1px solid var(--dark-border);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.4);
        }

        h1 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-text);
        }

        input[type="url"] {
            width: 100%;
            padding: 15px;
            background: #2A2A2A;
            border: 2px solid var(--dark-border);
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
            color: var(--dark-text);
        }

        input[type="url"]:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(139, 95, 191, 0.3);
        }

        .glow-button {
            background: linear-gradient(to right, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .glow-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            transition: left 0.7s ease-in-out;
        }

        .glow-button:hover::before {
            left: 100%;
        }

        .glow-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 95, 191, 0.5);
        }

        .glow-button:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .glow-button:disabled::before {
            display: none;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: var(--border-radius);
            background-color: rgba(106, 236, 179, 0.1);
            border-left: 4px solid var(--success);
            display: none;
        }

        .result a {
            color: var(--success);
            font-weight: 600;
            word-break: break-all;
        }

        .encrypted-info {
            margin-top: 10px;
            padding: 10px;
            background: rgba(139, 95, 191, 0.1);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .encrypted-url {
            color: var(--accent);
            font-family: monospace;
            word-break: break-all;
        }

        .timer {
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            display: none;
        }

        .timer span {
            font-weight: 700;
            color: var(--warning);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            text-align: center;
        }

        .stat-box {
            background: rgba(139, 95, 191, 0.1);
            padding: 15px;
            border-radius: var(--border-radius);
            color: var(--dark-text);
            min-width: 120px;
            border: 1px solid var(--dark-border);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            border-top: 1px solid var(--dark-border);
            width: 100%;
            opacity: 0.7;
        }

        .promo {
            background: var(--dark-card);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            margin-top: 30px;
            border: 1px solid var(--dark-border);
            display: none;
        }

        .promo h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .promo p {
            margin-bottom: 15px;
        }

        .promo-btn {
            background: linear-gradient(to right, var(--warning), var(--accent));
            width: auto;
            display: inline-block;
            padding: 12px 25px;
        }

        .countdown {
            font-size: 2rem;
            font-weight: 700;
            color: var(--warning);
            margin: 10px 0;
        }

        .error {
            color: var(--warning);
            margin-top: 10px;
            font-weight: 600;
            display: none;
        }

        .success {
            color: var(--success);
            margin-top: 10px;
            font-weight: 600;
            display: none;
        }

        .cooldown-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--accent);
            text-align: center;
        }

        .redirect-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(139, 95, 191, 0.1);
            border-radius: var(--border-radius);
            text-align: center;
            display: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .ad-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            max-width: 300px;
            animation: slideIn 0.5s ease-out;
            display: none;
        }

        .ad-notification h4 {
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .ad-notification p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .ad-notification .close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .logo {
                font-size: 2.5rem;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }

            .ad-notification {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã -->
    <div class="ad-notification" id="ad-notification-1">
        <h4>üéâ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!</h4>
        <p>–ü–æ–ª—É—á–∏—Ç–µ —Å–∫–∏–¥–∫—É 20% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑</p>
        <button class="close-btn" onclick="closeAd(1)">‚úï</button>
    </div>

    <div class="ad-notification" id="ad-notification-2">
        <h4>üî• –ì–æ—Ä—è—â–∏–µ —Ç–æ–≤–∞—Ä—ã!</h4>
        <p>–¢–æ–≤–∞—Ä—ã —Å–æ —Å–∫–∏–¥–∫–æ–π –¥–æ 50% –∂–¥—É—Ç –≤–∞—Å</p>
        <button class="close-btn" onclick="closeAd(2)">‚úï</button>
    </div>

    <div class="ad-notification" id="ad-notification-3">
        <h4>üöÄ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞!</h4>
        <p>–ó–∞–∫–∞–∂–∏—Ç–µ —Å–µ–π—á–∞—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É</p>
        <button class="close-btn" onclick="closeAd(3)">‚úï</button>
    </div>

    <div class="container">
        <header>
            <div class="logo">EsLink</div>
            <div class="tagline">–ë—ã—Å—Ç—Ä–æ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫</div>
        </header>

        <div class="card">
            <h1>–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –≤–∞—à—É —Å—Å—ã–ª–∫—É</h1>
            <form id="shorten-form">
                <div class="form-group">
                    <label for="url-input">–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è (–º–∞–∫—Å. 128 —Å–∏–º–≤–æ–ª–æ–≤):</label>
                    <input type="url" id="url-input" placeholder="https://example.com/very-long-url" required>
                    <div class="error" id="url-error">–û—à–∏–±–∫–∞: –°—Å—ã–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–µ –¥–ª–∏–Ω–Ω–µ–µ 128 —Å–∏–º–≤–æ–ª–æ–≤</div>
                    <div class="success" id="url-success">–°—Å—ã–ª–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∞!</div>
                </div>
                <button type="submit" id="shorten-btn" class="glow-button">–°–æ–∫—Ä–∞—Ç–∏—Ç—å —Å—Å—ã–ª–∫—É</button>
                <div class="cooldown-info" id="cooldown-info">–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É</div>
            </form>
            
            <div class="result" id="result">
                <div>–í–∞—à–∞ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞: <a href="#" id="short-url" target="_blank"></a></div>
                <div class="encrypted-info">
                    <strong>–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π URL:</strong>
                    <div class="encrypted-url" id="encrypted-url"></div>
                    <small>–î–ª–∏–Ω–∞: <span id="url-length">0</span> —Å–∏–º–≤–æ–ª–æ–≤ (–º–∞–∫—Å. 64)</small>
                </div>
            </div>

            <div class="redirect-info" id="redirect-info">
                <h3>–•–û–¢–ò–¢–ï —Å–æ–∫—Ä–∞—â–∞—Ç—å —Å—Å—ã–ª–∫–∏?</h3>
                <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π, –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ –∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö —Ü–µ–ª–µ–π</p>
                <button class="glow-button promo-btn" id="promo-btn">–ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å EsLink</button>
            </div>
        </div>

        <div class="timer" id="redirect-timer">
            –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑: <span id="countdown">10</span> —Å–µ–∫—É–Ω–¥
        </div>

        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="links-count">5179</div>
                <div class="stat-label">–°–æ–∑–¥–∞–Ω–æ —Å—Å—ã–ª–æ–∫</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="redirects-count">54912</div>
                <div class="stat-label">–ü–µ—Ä–µ—Ö–æ–¥–æ–≤</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="cooldown-time">60</div>
                <div class="stat-label">–°–µ–∫—É–Ω–¥ –æ–∂–∏–¥–∞–Ω–∏—è</div>
            </div>
        </div>

        <div class="footer">
            <p>EsLink &copy; <span id="current-year"></span> - –ù–∞–¥–µ–∂–Ω—ã–π —Å–æ–∫—Ä–∞—â–∞—Ç–µ–ª—å —Å—Å—ã–ª–æ–∫</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
            const form = document.getElementById('shorten-form');
            const urlInput = document.getElementById('url-input');
            const shortenBtn = document.getElementById('shorten-btn');
            const resultDiv = document.getElementById('result');
            const shortUrlLink = document.getElementById('short-url');
            const encryptedUrlElement = document.getElementById('encrypted-url');
            const urlLengthElement = document.getElementById('url-length');
            const urlError = document.getElementById('url-error');
            const urlSuccess = document.getElementById('url-success');
            const redirectTimer = document.getElementById('redirect-timer');
            const countdownElement = document.getElementById('countdown');
            const cooldownInfo = document.getElementById('cooldown-info');
            const promoBtn = document.getElementById('promo-btn');
            const redirectInfo = document.getElementById('redirect-info');
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const linksCountElement = document.getElementById('links-count');
            const redirectsCountElement = document.getElementById('redirects-count');
            const cooldownTimeElement = document.getElementById('cooldown-time');
            
            // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            let lastRequestTime = 0;
            const COOLDOWN_TIME = 60000;
            let linksCount = 5179;
            let redirectsCount = 54912;
            let adInterval;
            
            // –°–ª–æ–≤–∞—Ä—å –∑–∞–º–µ–Ω –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ –∏ —Ñ–∞–π–ª–æ–≤
            const domainReplacements = {
                'mediafire.com': 'mf',
                'youtube.com': 'yt',
                'google.com': 'gg',
                'drive.google.com': 'gd',
                'mega.nz': 'mz',
                'dropbox.com': 'db',
                'github.com': 'gh'
            };

            const fileReplacements = {
                '.mp4': '.v',
                '.mp3': '.a',
                '.pdf': '.d',
                '.doc': '.w',
                '.docx': '.wx',
                '.zip': '.z',
                '.rar': '.r',
                '.jpg': '.i',
                '.jpeg': '.i',
                '.png': '.i',
                '.gif': '.i'
            };

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            updateStats();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
            const urlParams = new URLSearchParams(window.location.search);
            const linkId = urlParams.get('id');
            
            if (linkId) {
                // –≠—Ç–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–µ–∫–ª–∞–º—É
                showRedirectPage(linkId);
                startAdSequence();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const url = urlInput.value.trim();
                
                if (url.length > 128) {
                    showError();
                    return;
                }
                
                const currentTime = Date.now();
                if (currentTime - lastRequestTime < COOLDOWN_TIME) {
                    const remainingTime = Math.ceil((COOLDOWN_TIME - (currentTime - lastRequestTime)) / 1000);
                    cooldownInfo.textContent = `–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ ${remainingTime} —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π —Å—Å—ã–ª–∫–∏`;
                    cooldownInfo.style.color = 'var(--warning)';
                    return;
                }
                
                hideError();
                hideSuccess();
                createShortLink(url);
                lastRequestTime = currentTime;
                updateCooldownInfo();
            });
            
            // –§—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å—Å—ã–ª–∫–∏
            function encryptUrl(url) {
                let processedUrl = url;
                
                // –£–¥–∞–ª—è–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª
                processedUrl = processedUrl.replace(/^https?:\/\//, '');
                
                // –ó–∞–º–µ–Ω—è–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–æ–º–µ–Ω—ã
                Object.keys(domainReplacements).forEach(domain => {
                    const regex = new RegExp(domain, 'gi');
                    processedUrl = processedUrl.replace(regex, domainReplacements[domain]);
                });
                
                // –ó–∞–º–µ–Ω—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
                Object.keys(fileReplacements).forEach(ext => {
                    const regex = new RegExp('\\' + ext, 'gi');
                    processedUrl = processedUrl.replace(regex, fileReplacements[ext]);
                });
                
                // –ó–∞–º–µ–Ω—è–µ–º –¥–ª–∏–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ –∫–æ–¥—ã
                processedUrl = processedUrl
                    .replace(/download/gi, 'dl')
                    .replace(/upload/gi, 'up')
                    .replace(/file/gi, 'f')
                    .replace(/folder/gi, 'fd')
                    .replace(/document/gi, 'doc')
                    .replace(/image/gi, 'img')
                    .replace(/video/gi, 'vid')
                    .replace(/audio/gi, 'aud');
                
                // –ö–æ–¥–∏—Ä—É–µ–º –æ—Å—Ç–∞–≤—à—É—é—Å—è —á–∞—Å—Ç—å –≤ base64 –∏ —É–∫–æ—Ä–∞—á–∏–≤–∞–µ–º
                let encoded = btoa(processedUrl).replace(/[+/=]/g, '');
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É –¥–æ 48 —Å–∏–º–≤–æ–ª–æ–≤
                if (encoded.length > 48) {
                    encoded = encoded.substring(0, 48);
                }
                
                // –°–æ–∑–¥–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π URL —Å –¥–æ–º–µ–Ω–æ–º eslnk.xo.je
                const finalUrl = `https://eslnk.xo.je/?id=${encoded}`;
                
                return {
                    encrypted: finalUrl,
                    length: finalUrl.length,
                    original: url
                };
            }
            
            // –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ —Å—Å—ã–ª–∫–∏
            function decryptUrl(encryptedUrl) {
                try {
                    // –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–¥ –∏–∑ URL eslnk.xo.je
                    const urlObj = new URL(encryptedUrl);
                    let code = urlObj.searchParams.get('id');
                    
                    if (!code) return null;
                    
                    // –î–µ–∫–æ–¥–∏—Ä—É–µ–º –∏–∑ base64
                    let decoded = atob(code);
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–º–µ–Ω–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
                    Object.keys(domainReplacements).forEach(domain => {
                        const short = domainReplacements[domain];
                        const regex = new RegExp('\\b' + short + '\\b', 'gi');
                        decoded = decoded.replace(regex, domain);
                    });
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
                    Object.keys(fileReplacements).forEach(ext => {
                        const short = fileReplacements[ext];
                        const regex = new RegExp('\\' + short + '(?=\\?|$|\\/)', 'gi');
                        decoded = decoded.replace(regex, ext);
                    });
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–æ–≤–∞
                    decoded = decoded
                        .replace(/\bdl\b/gi, 'download')
                        .replace(/\bup\b/gi, 'upload')
                        .replace(/\bf\b/gi, 'file')
                        .replace(/\bfd\b/gi, 'folder')
                        .replace(/\bimg\b/gi, 'image')
                        .replace(/\bvid\b/gi, 'video')
                        .replace(/\baud\b/gi, 'audio');
                    
                    return 'https://' + decoded;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏:', error);
                    return null;
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
            function showRedirectPage(linkId) {
                document.querySelector('.card').style.display = 'none';
                document.querySelector('.stats').style.display = 'none';
                redirectTimer.style.display = 'block';
                redirectInfo.style.display = 'block';
                
                const links = JSON.parse(localStorage.getItem('eslink_links') || '[]');
                const link = links.find(l => l.id === linkId);
                
                if (link) {
                    let countdown = 10;
                    countdownElement.textContent = countdown;
                    
                    const countdownInterval = setInterval(function() {
                        countdown--;
                        countdownElement.textContent = countdown;
                        
                        if (countdown <= 0) {
                            clearInterval(countdownInterval);
                            clearInterval(adInterval);
                            redirectsCount++;
                            updateStats();
                            
                            // –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º URL –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
                            const originalUrl = decryptUrl(link.encrypted);
                            if (originalUrl) {
                                window.location.href = originalUrl;
                            } else {
                                window.location.href = link.original;
                            }
                        }
                    }, 1000);
                } else {
                    countdownElement.textContent = '0';
                    redirectTimer.innerHTML = '–°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–∞';
                }
            }
            
            // –ó–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            function startAdSequence() {
                let adIndex = 1;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å—Ä–∞–∑—É
                showAd(adIndex);
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
                adInterval = setInterval(function() {
                    adIndex++;
                    if (adIndex > 3) adIndex = 1;
                    showAd(adIndex);
                }, 3000);
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–ª–∞–º–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            function showAd(index) {
                for (let i = 1; i <= 3; i++) {
                    document.getElementById(`ad-notification-${i}`).style.display = 'none';
                }
                
                const ad = document.getElementById(`ad-notification-${index}`);
                ad.style.display = 'block';
                
                setTimeout(() => {
                    if (ad.style.display === 'block') {
                        ad.style.display = 'none';
                    }
                }, 2500);
            }
            
            // –ó–∞–∫—Ä—ã—Ç—å —Ä–µ–∫–ª–∞–º–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            window.closeAd = function(index) {
                document.getElementById(`ad-notification-${index}`).style.display = 'none';
            }
            
            // –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–π —Å—Å—ã–ª–∫–∏
            function createShortLink(url) {
                const shortId = generateShortId(8);
                const shortUrl = `${window.location.origin}${window.location.pathname}?id=${shortId}`;
                
                // –®–∏—Ñ—Ä—É–µ–º URL
                const encryptedData = encryptUrl(url);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                saveLinkToStorage(url, shortUrl, shortId, encryptedData.encrypted);
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                shortUrlLink.href = shortUrl;
                shortUrlLink.textContent = shortUrl;
                encryptedUrlElement.textContent = encryptedData.encrypted;
                urlLengthElement.textContent = encryptedData.length;
                resultDiv.style.display = 'block';
                showSuccess();
                
                linksCount++;
                updateStats();
                urlInput.value = '';
            }
            
            function saveLinkToStorage(originalUrl, shortUrl, shortId, encryptedUrl) {
                const links = JSON.parse(localStorage.getItem('eslink_links') || '[]');
                links.push({
                    id: shortId,
                    original: originalUrl,
                    short: shortUrl,
                    encrypted: encryptedUrl,
                    created: new Date().toISOString(),
                    clicks: 0
                });
                localStorage.setItem('eslink_links', JSON.stringify(links));
            }
            
            function generateShortId(maxLength = 8) {
                const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
                let result = '';
                for (let i = 0; i < maxLength; i++) {
                    result += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return result;
            }
            
            function showError() {
                urlError.style.display = 'block';
                urlSuccess.style.display = 'none';
            }
            
            function hideError() {
                urlError.style.display = 'none';
            }
            
            function showSuccess() {
                urlSuccess.style.display = 'block';
                urlError.style.display = 'none';
            }
            
            function hideSuccess() {
                urlSuccess.style.display = 'none';
            }
            
            function updateCooldownInfo() {
                const currentTime = Date.now();
                const timePassed = currentTime - lastRequestTime;
                
                if (timePassed < COOLDOWN_TIME) {
                    const remainingTime = Math.ceil((COOLDOWN_TIME - timePassed) / 1000);
                    cooldownInfo.textContent = `–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Å—ã–ª–∫—É —á–µ—Ä–µ–∑ ${remainingTime} —Å–µ–∫—É–Ω–¥`;
                    cooldownInfo.style.color = 'var(--warning)';
                    setTimeout(updateCooldownInfo, 1000);
                } else {
                    cooldownInfo.textContent = '–í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É';
                    cooldownInfo.style.color = 'var(--success)';
                }
            }
            
            function updateStats() {
                linksCountElement.textContent = linksCount;
                redirectsCountElement.textContent = redirectsCount;
                cooldownTimeElement.textContent = COOLDOWN_TIME / 1000;
                localStorage.setItem('eslink_stats', JSON.stringify({
                    linksCount,
                    redirectsCount
                }));
            }
            
            promoBtn.addEventListener('click', function() {
                window.location.href = window.location.origin + window.location.pathname;
            });
            
            updateCooldownInfo();
        });
    </script>
</body>
</html>